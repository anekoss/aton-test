# Тестовое задание в команду команду технологий фронт-офиса

### Задание 2

Представим на время, что вы black hat, и у вас в распоряжении оказались данные ~30 млн. заказов некоторого сервиса
доставки еды за некоторый период 2021 и 2022 года.
Поверхностный анализ показал, что данные содержат 18 758 328 уникальных телефонов с полным именем клиента, а
средняя длина полного имени - 20 символов (латинских или кириллических).
Допустим, вы хотите развернуть веб-сервис, который позволит по номеру телефона найти полное имя клиента. Но вы не
хотите оставлять следы на диске или в базе данных - придется все держать в памяти. Но еще вы не хотите зря тратить
крипту на слишком большой сервер.

### если мы хотим реализовать поиск за постоянное время, т.е. O(1)?
Для поиска имя клиента по номеру телефона за O(1) стоит использовать HashMap с ключем по номеру телефона.

Всего найдено 18 758 328 уникальных телефонов с полным именем клиентом, т.е. храниться будет 18 758 328 пар ключ - значение.

```java
Map<Integer, String> numberPersons = new HashMap<>();
```

HashMap - это массив объектов типа Node

```java
class Node<K,V> implements Map.Entry<K,V> {
    final int hash;
    final K key;
    V value;
    Node<K,V> next;
}
```

Максимальный размер номера телефона в России: 11 цифр (с кодом страны или "восьмеркой"), т.е. для ключа достаточно использовать тип те

**Размер int:** 16 байт

**Размер ФИО:** ~ 2*20 = 40 байт

Итого, размер данных: `56 байт`

**Для 64-битной JVM:**

Каждая ссылка занимает 8 байт.

**Размер ноды:** 16 + 8 + 8 + 8 = `40 байт`

Таким образом, для хранения 18 758 328 пар ключ-значения понадобится:

`(40 + 56) * 18 758 328 = 1,677 Гб`

### если мы хотим занять как можно меньше памяти?

Если мы хотим занять как можно меньше памяти, целесообразно использовать массив объектов типа Person

```java
record Person(String fio, int number) {
}
```

**Размер данных:** 40 + 16 = `64 байта`

**Для 64-битной JVM:**

Каждая ссылка занимает 8 байт.

Person хранит две ссылки.

Таким образом, для для хранения 18 758 328 объктов типа Person понадобится:

`(64 + 16) * 18 758 328 = 1,398 Гб`

Также если использовать хранение данных в массиве, можно разделить фамилию, имя и отчество по разным полям, т.к. скорее всего будут повторения и для одинаковых строк память будет выделяться один раз.